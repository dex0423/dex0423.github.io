---
layout:     post
title:      数据埋点：数据埋点方式与策略
subtitle:   
date:       2022-01-27
author:     dex0423
header-img: img/post-bg-os-metro.jpg
catalog: true
tags:
    - 数据埋点
---



#### 埋点方式

- 事件埋点
  - 比如：用户登录；
- 页面埋点
  - 页面打开、关闭
- 曝光埋点
  - 比如：广告（用于计算曝光数）
  - 有效曝光 / 逻辑可见：
    - 停留时间大于 2 秒；
  - 曝光逻辑：
    - 一个模块只曝光一次、且上报一次（如果已经上报，就不做二次上报）；
    - 标题曝光，即视为模块模块曝光；


#### 前端埋点 & 后端埋点

- 前端埋点为主，后端埋点为辅；
- 后端数据作为标准，前端数据作为参考；
- 很多时候，需要相互配合；
  - 比如：
    - 判定用户登录是否成功，需要后端判定登录状态，结合前端的登录行为才能判定；
    - 获取用户的支付信息，前端只展示标出来的价格，但实际支付的时候可能会有优惠，需要结合后端的支付数据才能确定实际价格；


#### 埋点策略

- 代码埋点
  - 指令式埋点：
    - 用户在埋点位置触发事件，由预先定义的函数上报事件相关数据。
    - 缺点：
      - 和业务耦合度比较高，每增加需求都要做版本更新迭代；
      - 代码开发的工作量比较大；
      - 开发成本较高。
  - 声明式埋点：
    - 预先声明埋点类型（提前封装好自定义的指令），在 DOM 或者组件上，通过设置即可以完成事件的统一上报；
    - 优点：
      - 埋点和业务代码实现了解耦；
      - VUE 比较流行的埋点方式。
- 全埋点
  - 全部免采集用户的行为；
  - 优点：
    - 数据全部采集，不会有遗漏；
    - 全生命周期的采集和分析；
  - 缺点：
    - 后端日志服务器亚历山大；
    - 占用网络资源，对用户浏览体验也会有影响；
- 可视化埋点
  - 通过可视化的自定义埋点；
  - 优点：
    - 操作简单；
    - 支持自定义属性；
    - 适用于非技术人员进行埋点工作；
  - 缺点：
    - 覆盖的功能有限，不支持后端埋点；
    - 开发难度大，需要在 web 短提前解析 DOM，并将解析后的 DOM 进行可视化，并能实现准确的自定义配置，对开发要求比较高。
- 第三方 SDK 埋点
  - 神策
  - 诸葛
  - Growing IO
  - 只需要集成 SDK 就可以实现埋点；
  - 基本都提供私有化部署，不用担心数据安全问题。

  ![]({{site.baseurl}}/img-post/数据埋点-2.png)

#### 第三方工具存在的问题

- 非实时反馈
- 数据波动难以定位
- 与第三方沟通成本太高
- 没有自己的核心数据存储

- 电商时间埋点方案示例

  ![]({{site.baseurl}}/img-post/指标体系方法论-5.png)



