---
layout:     post
title:      数据埋点：数据埋点方式与策略
subtitle:   
date:       2022-01-27
author:     dex0423
header-img: img/post-bg-os-metro.jpg
catalog: true
tags:
    - 数据埋点
---

# 1. 埋点设计

#### 1.1. 埋点的要求

- 数据稳定准确，反映真实业务场景
- 需要长期监控，数据需要长期存储
- 业务属性丰富，可以做深度业务分析
- 对于核心 KPI，指标需要全面覆盖
- 需要设置数据权限

#### 1.2. 埋点事件设计原则

- 驼峰命名法；
- 命名格式：模块_页面_事件；
- 区分公共事件，
  - 如设备、位置、机型等，不要每次都上报，这样可以大大减少数据冗余；
- 相同的功能事件设置相同的 event_id，通过属性参数来做区分；

#### 1.3. 埋点日志基本字段

- 用户 ID
- 事件名称
- 事件 ID
- 所在页面（位置）
- 属性
- 属性值
- 时间
  - 设备上报时间
  - 到达服务器的时间

#### 1.4. 多维事件模型

- event 事件模型
  - 使用 event 记录用户在产品上的各种行为；
  - What
  - When
  - Where
  - Who
  - How
- user 用户模型
  - user 的基础属性信息
- 二者既可以分别分析，也可以关联分析。

#### 1.5. 埋点需求基本要素

- 上报时间
- 涉及页面
- 用户信息
- 系统信息
- 触发条件（session 回溯）
- 上报位置


# 2. 埋点事件

#### 2.1. 埋点事件表

- 事件表示例：

    ![]({{site.baseurl}}/img-post/数据埋点-3.png)

- 埋点位置
  - 如果业务覆盖了APP、Web和小程序平台，分开管理会造成指标冗余；
  - 对于多平台存在的核心指标，采用的是统一事件名定义；
  - 不同平台触发时，数据上报到同一个事件名上，通过平台类型（platform_type）进行拆分；

- 事件定义：
  - 比较难处理的是【触发条件】的准确定义和描述，如页面的进度数据，触发定义成加载和加载成功完全不同；
  - 比如，首页模块浏览，模块长短不一，到何种深度会触发对应模块的浏览，需要定义时想清楚，与开发沟通实现细节，避免后期踩坑；

- 参数定义：
  - 用来定义事件的参数，也可以理解为事件维度；
  - 该字段决定了事件的颗粒度，直接影响到事件下钻的颗粒度；
  - 平台不同位置的事件抽象后，尽可能提取出公用事件，然后通过事件变量进行区分，这样做的好处是：减少指标冗余、指标管理工作、培训成本，以及使用者的学习成本。
  - 当然这里也并不完全执着于抽象公用性，对于数据PM和开发来说，指标越精简越好，便于理解和管理，但对于运营同事来说，学习和使用成本高企，数据产生了但无法最大化应用侧价值，那就得不偿失，所以需要平衡。


#### 2.2. 事件上报时机

- 事件埋点
  - 比如：下单成功；
- 页面埋点
  - 比如：完成页面跳转
- 曝光埋点
  - 进入页面时，模块可见面积大于 50%，才上报；
  - 手指不停的滑动，模块可见面积小于 50% 不上报，大于 50% 才上报；
  - 滑动停止时，模块可见面积小于 50% 不上报，大于 50% 才上报；


#### 2.3. 系统化管理埋点事件

- 实现统一的格式；
- 方便埋点查询、变更管理；
- 易于埋点元数据管理；
- 方便埋点生命周期管理；
- 便于进行埋点数据质量的监控。


# 3. 埋点项目

#### 3.1. 数据埋点工作流程

- 梳理埋点需求（分析指标体系）
- 制定埋点规则
  - 命名的规范化
  - 埋点流程统一化
- 制定埋点数据的清洗规则
  - 数据清洗规范化
- 维护埋点的测试、上线、下线
- 维护埋点元数据（埋点管理系统）

#### 3.2. 埋点项目示例

![]({{site.baseurl}}/img-post/指标体系方法论-4.png)

# 4. 埋点应用

#### 4.1. 埋点适用场景

- 抽象场景
  - 需要定期汇报考核 KPI
  - 需要周期性分析 KPI 增长情况
  - 需要对业务数据进行深度挖掘
  - 需要进行归因分析
  - 需要优化产品和运行策略
- 具体场景
  - 流量监控
    - 各功能模块使用情况分析
  - 活动效果评估
  - 用户行为日志
  - 用户画像
  - 漏斗分析
  - 留存分析
  - 活跃分析
  - 互动分析
  - 算法推荐（千人千面）
  - A/B 测试
  - 广告投放
  - 波动警报

#### 4.2. OSM 模型

- Object
  - KPI，业务目标；
  - 如：
    - 拉新
    - 提升留存
    - 提高转化
    - 提升客单价
    - 降低客诉
- Strategy
  - 业务策略
- Measurement
  - 指标

#### 4.3. 多维事件模型

- event 事件模型
  - 使用 event 记录用户在产品上的各种行为；
  - What
  - When
  - Where
  - Who
  - How
- user 用户模型
  - user 的基础属性信息
- 二者既可以分别分析，也可以关联分析。