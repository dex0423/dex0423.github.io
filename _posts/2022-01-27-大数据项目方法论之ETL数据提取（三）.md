---
layout:     post
title:      大数据项目方法论之ETL数据提取（三）
subtitle:   数据标准化
date:       2022-01-27
author:     dex0423
header-img: img/post-bg-os-metro.jpg
catalog: true
tags:
    - 数仓
---


# 1. 数据标准化与数据清洗的区别

##### 1.1. 数据清晰

- 处理的问题：
  - 录入错误、输入错误，导致数据不可用；
  - 程序运行异常、规则错误，导致数据冗余、重复等；

- 处理的策略：
  - 校验、过滤、去重、置空；
  - 

![]({{site.baseurl}}/img-post/etl-6-1.png)

##### 1.2. 源数据存在的问题

业务部门的数据往往是有很多问题的，存在大量问题，

- 数据本身问题：
  - 建表命名不规范
  - 字段属性错误
  - 数据值录入错误
  - 数据丢失
  - 数据重复
- 设计问题：
  - 数据不规范
  - 格式不统一
- 需要看到数据，才能知道如何制定规则；
- 有些数据，需要跨部门联合检验；

##### 1.3. 数据清洗的价值

- 确保数据的可用性
  - 真实
  - 有效
  - 规范
  - 统一
- 反向提升业务系统
  - 及时发现问题，并提交给来源系统做问题定位和整改，进而提升数据的可用性。

# 2. 数据清洗规则

##### 2.1. 数据过滤

- 基于样本数据过滤
  - 主要用于处理垃圾数据：
  - 比如：垃圾样本库
    - 垃圾短信
    - 垃圾邮件
- 基于业务规则过滤
  - 比如：无效日志
    - 网络攻击
    - 爬虫

##### 2.2. 数据去重

- 全业务字段重复
  - 一般出现在数据同步过程中，
  - 比如同步任务异常、或者 kafka 同步的数据本身就存在重复；
  - 需要设定唯一主键，防止出现重复。
- 业务规则重复
  - 根绝业务规则判定需要保留的数据
  - 比如：一个身份证号对应多个用户ID

##### 2.3. 格式转换

- 日期时间
- 全角半角
- 大小写
- 经纬度
- 设备 Mac 地址

##### 2.4. 内容校验

- 合规性校验：基于规则
  - 身份证合规
    - 行政区划、年份、月份、日期，需要符合规则
  - 手机号合规
    - 位数
    - 号段
    - 事实表多表联合校验
  - 邮箱地址合规
  - 组织结构代码证合规
  - 地址信息合规
- 一致性校验：
  - 属性一致性
  - 关系一致性
- 其他校验：
  - 值域范围
    - 一般需要与维度表联合校验
    - 比如：
      - ID：某订单数据的商品ID为10001，但商品表ID字段值域范围最大是10000，超出了值域范围；
      - 性别：性别为 3，不在性别维度表 0（未填写）、1（男）、2（女）值域范围内；

  - 数据格式
    - 比如：
      - 概率：概率值应该为 0~1，但实际确实 2、3、4 等；
      - 年龄：应该为整数值，并且在0~120之间。
  - 空值校验
    - 非空字段
      - 比如：年龄、性别
    - 可为空字段
      - 比如：爱好
  - 准确性校验
    - 比如：
      - 业务人员一、二级部门归属；
  - 完整性校验
  