---
layout:     post
title:      数据埋点：数据埋点的事件模型
subtitle:   
date:       2022-01-24
author:     dex0423
header-img: img/post-bg-os-metro.jpg
catalog: true
tags:
    - 数据埋点
---

#### 事件模型

- 一个事件的触发，有4个因素：触发者、触发位置、触发的事件、触发的时间。

  ![]({{site.baseurl}}/img-post/数据埋点-6.png)


#### 触发者

- 触发者即触发事件的用户；
- 需要一个唯一标识，来识别不同的用户；
- 同时，需要识别在不同平台的同一个用户。

#### 触发位置

- 为了识别一个网页里面，事件触发的位置，需要一个页面的唯一标识、和控件的唯一标识；
- 页面的唯一标识
  - 一般通过 url 标记，但要处理好url后面的参数；
- 控件的唯一标识
  - 一般通过元素在整个文档中的xpath路径来标记。xpath是能唯一标记控件在网页的唯一位置的一种标记方法。

#### 触发的事件

- 事件类型有浏览、点击、曝光、悬浮，下拉、滚动、长按、右键等等，最常用的还是浏览和点击。

#### 触发时间

- 事件触发的时间一般取的是客户端时间，也就是用户的本地时间；
  - 如果用户的设备是移动端，取的就是手机时间，如果是电脑，取的就是电脑的时间。
- 但是客户端的时间不太准确，因为用户可以去更改设备时间，我们需要一个机制去校准客户端时间。
  - 一般的做法是，在上报事件时，我们会上报事件触发时间 t1 和数据发送时间 t2，服务端也会拿到一个接收数据的时间 t3；
  - 如果 t3-t2>60s，则认为客户端时间不准，要对客户端时间进行修正，修正后的客户端时间是：t1+(t3-t2)；
  - 之所以 t3-t2>60s 会认为不准，因为数据发送到接收的时间，一般不会超过60s。